{"version":3,"sources":["../src/electron/game-window.ts"],"names":[],"mappings":";AAAA,kEAAkE;AAClE,sEAAsE;AACtE,IAAM,QAAQ,GAAG,OAAO,CAAC,mBAAmB,CAAC,CAAC;AAC9C,IAAM,QAAQ,GAAG,OAAO,CAAC,UAAU,CAAC,CAAC;AAC7B,IAAA,kBAAG,EAAE,oBAAI,CAAc;AAE/B,yCAAwC;AACxC,2DAAwD;AAGxD;IAOI,oBAAY,WAAwB;QAN5B,YAAO,GAAY,KAAK,CAAC;QAO7B,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,+BAA+B,CAAC,CAAC;QACjE,IAAI,CAAC,GAAG,GAAG,IAAI,QAAQ,CAAC,aAAa,CAAC;YAClC,KAAK,EAAE,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,2BAA2B,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YAC5E,MAAM,EAAE,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,2BAA2B,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7E,KAAK,EAAE,eAAe;YACtB,cAAc,EAAE,IAAI;YACpB,MAAM,EAAE,IAAI;YACZ,cAAc,EAAE;gBACZ,oBAAoB,EAAE,KAAK;aAC9B;SACJ,CAAC,CAAC;QACH,IAAI,CAAC,SAAS,GAAG,IAAI,qBAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACzC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,iBAAiB,CAAC,qCAAgB,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;IACjF,CAAC;IAEM,wBAAG,GAAV;QACI,eAAe;QACf,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,YAAU,SAAS,2BAAwB,EACxD,EAAE,SAAS,EAAE,IAAI,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;QAEtC,WAAW;QACX,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEnC,iBAAiB;QACjB,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC;QAExB,EAAE,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC;YACf,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC;QACxC,CAAC;IACL,CAAC;IAEO,+BAAU,GAAlB;QACI,MAAM,CAAC,EAAE,CAAC;IACd,CAAC;IAEM,2BAAM,GAAb,UAAc,EAA2B;QAAzC,iBAKC;QAJG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,QAAQ,EAAE;YAClB,KAAI,CAAC,GAAG,GAAG,IAAI,CAAC;YAChB,EAAE,CAAC,KAAI,CAAC,CAAC;QACb,CAAC,CAAC,CAAC;IACP,CAAC;IACL,iBAAC;AAAD,CAlDA,AAkDC,IAAA;AAlDY,gCAAU","file":"game-window.js","sourcesContent":["/// <reference path=\"../../node_modules/@types/node/index.d.ts\" />\n/// <reference path=\"../../node_modules/@types/electron/index.d.ts\" />\nconst settings = require('electron-settings');\nconst electron = require('electron');\nconst { app, Menu } = electron;\n\nimport { ShortCuts } from './shortcuts';\nimport { GameMenuTemplate } from './game-menu.template';\nimport { Application } from './application';\n\nexport class GameWindow {\n    private devMode: boolean = false;\n    private win: Electron.BrowserWindow;\n    private application: Application;\n    private menu: Electron.Menu;\n    public shortCuts: ShortCuts;\n\n    constructor(application: Application) {\n        this.application = application;\n        this.devMode = settings.getSync('option.general.developer-mode');\n        this.win = new electron.BrowserWindow({\n            width: parseInt(settings.getSync('option.general.resolution').split(';')[0]),\n            height: parseInt(settings.getSync('option.general.resolution').split(';')[1]),\n            title: 'DofusTouch-NE',\n            useContentSize: true,\n            center: true,\n            webPreferences: {\n                backgroundThrottling: false\n            }\n        });\n        this.shortCuts = new ShortCuts(this.win);\n        this.menu = Menu.buildFromTemplate(GameMenuTemplate.build(this.application));\n    }\n\n    public run(): void {\n        // load the app\n        this.win.loadURL(`file://${__dirname}/../browser/index.html`,\n            { userAgent: this.generateUA() });\n\n        // set menu\n        Menu.setApplicationMenu(this.menu);\n\n        // bind shortcuts\n        this.shortCuts.enable();\n\n        if (this.devMode) {\n            this.win.webContents.openDevTools();\n        }\n    }\n\n    private generateUA(): string {\n        return \"\";\n    }\n\n    public closed(cb: (e: GameWindow) => void): void {\n        this.win.on('closed', () => {\n            this.win = null;\n            cb(this);\n        });\n    }\n}\n"]}